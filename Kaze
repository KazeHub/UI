local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")

local function CreateWindow(config)
    config = config or {}

    local TitleText = config.Title or "UI Window"
    local AuthorText = config.Author or ""
    local VersionText = config.Version or ""
    local ThemeColor = config.ThemeColor or Color3.fromRGB(0, 255, 255)

    local PlayerGui = Players.LocalPlayer:WaitForChild("PlayerGui")

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WindLikeUI"
    ScreenGui.IgnoreGuiInset = true
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = PlayerGui

    local Main = Instance.new("Frame")
    Main.Size = UDim2.fromScale(0.75, 0.75)
    Main.Position = UDim2.fromScale(0.5, 0.5)
    Main.AnchorPoint = Vector2.new(0.5, 0.5)
    Main.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    Main.BackgroundTransparency = 0.15
    Main.Parent = ScreenGui

    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 16)

    local Stroke = Instance.new("UIStroke")
    Stroke.Color = ThemeColor
    Stroke.Thickness = 1.5
    Stroke.Transparency = 0.2
    Stroke.Parent = Main

    local TopBar = Instance.new("Frame")
    TopBar.Size = UDim2.new(1, 0, 0, 54)
    TopBar.BackgroundTransparency = 1
    TopBar.Parent = Main

    local Title = Instance.new("TextLabel")
    Title.Text = TitleText
    Title.Font = Enum.Font.GothamSemibold
    Title.TextSize = 18
    Title.TextXAlignment = Left
    Title.TextColor3 = Color3.fromRGB(240,240,240)
    Title.BackgroundTransparency = 1
    Title.Position = UDim2.fromOffset(16, 6)
    Title.Size = UDim2.new(1, -120, 0, 24)
    Title.Parent = TopBar

    local Author = Instance.new("TextLabel")
    Author.Text = AuthorText .. " " .. VersionText
    Author.Font = Enum.Font.Gotham
    Author.TextSize = 13
    Author.TextXAlignment = Left
    Author.TextColor3 = Color3.fromRGB(180,180,180)
    Author.BackgroundTransparency = 1
    Author.Position = UDim2.fromOffset(16, 28)
    Author.Size = UDim2.new(1, -120, 0, 18)
    Author.Parent = TopBar

    local Close = Instance.new("TextButton")
    Close.Size = UDim2.fromOffset(36, 36)
    Close.Position = UDim2.new(1, -44, 0, 9)
    Close.Text = "✕"
    Close.Font = Enum.Font.GothamBold
    Close.TextSize = 16
    Close.TextColor3 = ThemeColor
    Close.BackgroundTransparency = 1
    Close.Parent = TopBar

    local Content = Instance.new("Frame")
    Content.Position = UDim2.fromOffset(0, 54)
    Content.Size = UDim2.new(1, 0, 1, -54)
    Content.BackgroundTransparency = 1
    Content.Parent = Main

    local ReturnBtn = Instance.new("TextButton")
    ReturnBtn.Size = UDim2.fromOffset(48, 48)
    ReturnBtn.Position = UDim2.new(0, 18, 0.5, -24)
    ReturnBtn.Text = "≡"
    ReturnBtn.Font = Enum.Font.GothamBold
    ReturnBtn.TextSize = 20
    ReturnBtn.TextColor3 = ThemeColor
    ReturnBtn.BackgroundColor3 = Color3.fromRGB(20,20,20)
    ReturnBtn.BackgroundTransparency = 0.15
    ReturnBtn.Visible = false
    ReturnBtn.Parent = ScreenGui

    Instance.new("UICorner", ReturnBtn).CornerRadius = UDim.new(1,0)
    Instance.new("UIStroke", ReturnBtn).Color = ThemeColor

    Close.MouseButton1Click:Connect(function()
        Main.Visible = false
        ReturnBtn.Visible = true
    end)

    ReturnBtn.MouseButton1Click:Connect(function()
        Main.Visible = true
        ReturnBtn.Visible = false
    end)

    local dragging, dragStart, startPos

    TopBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = Main.Position
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            Main.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)

    return {
        ScreenGui = ScreenGui,
        Main = Main,
        Content = Content,

        SetTitle = function(newTitle)
            Title.Text = tostring(newTitle)
        end,

        SetAuthor = function(newAuthor, newVersion)
            Author.Text = tostring(newAuthor or "") .. " " .. tostring(newVersion or "")
        end,

        Destroy = function()
            ScreenGui:Destroy()
        end
    }
end

return CreateWindow
