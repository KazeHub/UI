--[[
    Custom Roblox UI Framework
    Style: RedzHub / WindUI inspired
    Version: 1.0.1
]]

--// SERVICES
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer

--// LIB
local UILib = {}
UILib.__index = UILib

--// =========================
--// CREATE WINDOW
--// =========================
function UILib:CreateWindow(settings)
    settings = settings or {}

    local Window = {}
    Window.Tabs = {}

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "CustomUILib"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

    local Main = Instance.new("Frame")
    Main.Size = UDim2.fromOffset(520,360)
    Main.Position = UDim2.fromScale(0.5,0.5)
    Main.AnchorPoint = Vector2.new(0.5,0.5)
    Main.BackgroundColor3 = Color3.fromRGB(25,25,25)
    Main.ClipsDescendants = true
    Main.Parent = ScreenGui

    Instance.new("UICorner", Main).CornerRadius = UDim.new(0,12)
    Instance.new("UIStroke", Main).Color = settings.ThemeColor or Color3.fromRGB(0,255,255)

    --// TOP BAR
    local TopBar = Instance.new("Frame")
    TopBar.Size = UDim2.new(1,0,0,44)
    TopBar.BackgroundColor3 = Color3.fromRGB(30,30,30)
    TopBar.Parent = Main

    -- Icon
    local Icon = Instance.new("ImageLabel")
    Icon.Size = UDim2.fromOffset(28,28)
    Icon.Position = UDim2.fromOffset(8,8)
    Icon.BackgroundTransparency = 1
    Icon.Image = settings.Icon or "rbxassetid://0"
    Icon.Parent = TopBar
    Instance.new("UICorner", Icon).CornerRadius = UDim.new(1,0)

    -- Title
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1,-200,1,0)
    Title.Position = UDim2.fromOffset(44,0)
    Title.BackgroundTransparency = 1
    Title.Text = settings.Title or "UI Window"
    Title.TextColor3 = Color3.new(1,1,1)
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 14
    Title.Parent = TopBar

    -- Author / Version
    local Info = Instance.new("TextLabel")
    Info.Size = UDim2.fromOffset(160,44)
    Info.Position = UDim2.new(1,-160,0,0)
    Info.BackgroundTransparency = 1
    Info.Text = (settings.Author or "Author") .. " • " .. (settings.Version or "1.0")
    Info.TextColor3 = Color3.fromRGB(180,180,180)
    Info.Font = Enum.Font.Gotham
    Info.TextSize = 12
    Info.Parent = TopBar

    -- Minimize
    local Minimize = Instance.new("TextButton")
    Minimize.Size = UDim2.fromOffset(40,44)
    Minimize.Text = "–"
    Minimize.Font = Enum.Font.GothamBold
    Minimize.TextSize = 22
    Minimize.TextColor3 = Color3.new(1,1,1)
    Minimize.BackgroundColor3 = Color3.fromRGB(35,35,35)
    Minimize.Parent = TopBar

    -- Close
    local Close = Instance.new("TextButton")
    Close.Size = UDim2.fromOffset(40,44)
    Close.Position = UDim2.fromOffset(40,0)
    Close.Text = "×"
    Close.Font = Enum.Font.GothamBold
    Close.TextSize = 18
    Close.TextColor3 = Color3.fromRGB(255,90,90)
    Close.BackgroundColor3 = Color3.fromRGB(35,35,35)
    Close.Parent = TopBar

    Close.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
    end)

    local minimized = false
    Minimize.MouseButton1Click:Connect(function()
        minimized = not minimized
        TweenService:Create(Main, TweenInfo.new(0.25), {
            Size = minimized and UDim2.fromOffset(520,44) or UDim2.fromOffset(520,360)
        }):Play()
    end)

    --// TAB BAR
    local TabsFrame = Instance.new("Frame")
    TabsFrame.Size = UDim2.new(0,120,1,-44)
    TabsFrame.Position = UDim2.fromOffset(0,44)
    TabsFrame.BackgroundColor3 = Color3.fromRGB(20,20,20)
    TabsFrame.Parent = Main

    local TabsLayout = Instance.new("UIListLayout", TabsFrame)
    TabsLayout.Padding = UDim.new(0,6)

    --// CONTENT
    local Content = Instance.new("Frame")
    Content.Size = UDim2.new(1,-120,1,-44)
    Content.Position = UDim2.fromOffset(120,44)
    Content.BackgroundTransparency = 1
    Content.Parent = Main

    --// CREATE TAB
    function Window:CreateTab(tabSettings)
        tabSettings = tabSettings or {}
        local Tab = {}

        local TabBtn = Instance.new("TextButton")
        TabBtn.Size = UDim2.new(1,-10,0,36)
        TabBtn.Text = tabSettings.Name or "Tab"
        TabBtn.Font = Enum.Font.Gotham
        TabBtn.TextSize = 13
        TabBtn.TextColor3 = Color3.new(1,1,1)
        TabBtn.BackgroundColor3 = Color3.fromRGB(35,35,35)
        TabBtn.Parent = TabsFrame
        Instance.new("UICorner", TabBtn).CornerRadius = UDim.new(0,8)

        local Page = Instance.new("ScrollingFrame")
        Page.Size = UDim2.fromScale(1,1)
        Page.CanvasSize = UDim2.fromOffset(0,0)
        Page.ScrollBarImageTransparency = 1
        Page.Visible = false
        Page.Parent = Content

        local PageLayout = Instance.new("UIListLayout", Page)
        PageLayout.Padding = UDim.new(0,8)

        PageLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            Page.CanvasSize = UDim2.fromOffset(0, PageLayout.AbsoluteContentSize.Y + 10)
        end)

        TabBtn.MouseButton1Click:Connect(function()
            for _,v in pairs(Content:GetChildren()) do
                if v:IsA("ScrollingFrame") then
                    v.Visible = false
                end
            end
            Page.Visible = true
        end)

        if #Content:GetChildren() == 1 then
            Page.Visible = true
        end

        -- Section
        function Tab:CreateSection(text)
            local Label = Instance.new("TextLabel")
            Label.Size = UDim2.new(1,-12,0,28)
            Label.Text = text
            Label.Font = Enum.Font.GothamBold
            Label.TextSize = 14
            Label.TextColor3 = Color3.fromRGB(200,200,200)
            Label.BackgroundTransparency = 1
            Label.Parent = Page
        end

        -- Button
        function Tab:CreateButton(text, callback)
            local Btn = Instance.new("TextButton")
            Btn.Size = UDim2.new(1,-12,0,32)
            Btn.Text = text
            Btn.Font = Enum.Font.Gotham
            Btn.TextSize = 13
            Btn.TextColor3 = Color3.new(1,1,1)
            Btn.BackgroundColor3 = Color3.fromRGB(45,45,45)
            Btn.Parent = Page
            Instance.new("UICorner", Btn).CornerRadius = UDim.new(0,8)
            Btn.MouseButton1Click:Connect(function()
                if callback then callback() end
            end)
        end

        -- Toggle
        function Tab:CreateToggle(text, default, callback)
            local state = default or false
            local Toggle = Instance.new("TextButton")
            Toggle.Size = UDim2.new(1,-12,0,32)
            Toggle.Text = text .. (state and ": ON" or ": OFF")
            Toggle.Font = Enum.Font.Gotham
            Toggle.TextSize = 13
            Toggle.TextColor3 = Color3.new(1,1,1)
            Toggle.BackgroundColor3 = Color3.fromRGB(45,45,45)
            Toggle.Parent = Page
            Instance.new("UICorner", Toggle).CornerRadius = UDim.new(0,8)

            Toggle.MouseButton1Click:Connect(function()
                state = not state
                Toggle.Text = text .. (state and ": ON" or ": OFF")
                if callback then callback(state) end
            end)
        end

        -- Textbox
        function Tab:CreateTextbox(placeholder, callback)
            local Box = Instance.new("TextBox")
            Box.Size = UDim2.new(1,-12,0,32)
            Box.PlaceholderText = placeholder
            Box.Text = ""
            Box.Font = Enum.Font.Gotham
            Box.TextSize = 13
            Box.TextColor3 = Color3.new(1,1,1)
            Box.BackgroundColor3 = Color3.fromRGB(45,45,45)
            Box.Parent = Page
            Instance.new("UICorner", Box).CornerRadius = UDim.new(0,8)

            Box.FocusLost:Connect(function()
                if callback then callback(Box.Text) end
            end)
        end

        return Tab
    end

    return Window
end

return UILib
