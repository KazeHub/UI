--// Kaze UI Library (Fixed & Remastered)
--// Built-in Toggle: RightControl

local KazeUI = {}
KazeUI.__index = KazeUI

--// Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")
local LP = Players.LocalPlayer

--// Theme Configuration
local THEME = {
	Glow = Color3.fromRGB(0, 230, 255), -- Glowing Blue
	Background = Color3.fromRGB(20, 20, 25),
	Header = Color3.fromRGB(15, 15, 20),
	Text = Color3.fromRGB(255, 255, 255),
	TextDim = Color3.fromRGB(160, 160, 160)
}

--// Create ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "KazeUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = LP:WaitForChild("PlayerGui")

--// UIScale logic
local UIScale = Instance.new("UIScale")
UIScale.Parent = ScreenGui

local function UpdateScale()
	local size = workspace.CurrentCamera.ViewportSize
	UIScale.Scale = (size.X < 600) and math.clamp(size.X / 800, 0.5, 1) or math.clamp(size.X / 1920, 0.6, 1)
end
UpdateScale()
workspace.CurrentCamera:GetPropertyChangedSignal("ViewportSize"):Connect(UpdateScale)

--// Image Formatter
local function FormatImage(id)
	local clean = string.gsub(tostring(id or ""), "%D", "")
	return clean ~= "" and "rbxassetid://" .. clean or ""
end

--// Dragging logic
local function MakeDraggable(dragPart, targetPart)
	local dragging, dragInput, dragStart, startPos
	dragPart.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = targetPart.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then dragging = false end
			end)
		end
	end)
	UIS.InputChanged:Connect(function(input)
		if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
			local delta = input.Position - dragStart
			targetPart.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		end
	end)
end

--// CREATE WINDOW
function KazeUI:CreateWindow(config)
	local Window = Instance.new("Frame")
	Window.Name = "MainWindow"
	Window.Size = UDim2.fromOffset(650, 420)
	Window.Position = UDim2.fromScale(0.5, 0.5)
	Window.AnchorPoint = Vector2.new(0.5, 0.5)
	Window.BackgroundColor3 = THEME.Background
	Window.BorderSizePixel = 0
	Window.Parent = ScreenGui
	Instance.new("UICorner", Window).CornerRadius = UDim.new(0, 10)

	-- Glowing Blue Border
	local WindowStroke = Instance.new("UIStroke")
	WindowStroke.Color = THEME.Glow
	WindowStroke.Thickness = 2
	WindowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	WindowStroke.Parent = Window

	-- Top Bar
	local TopBar = Instance.new("Frame")
	TopBar.Size = UDim2.new(1, 0, 0, 50)
	TopBar.BackgroundColor3 = THEME.Header
	TopBar.BorderSizePixel = 0
	TopBar.Parent = Window
	Instance.new("UICorner", TopBar).CornerRadius = UDim.new(0, 10)
	
	local TopFix = Instance.new("Frame")
	TopFix.Size = UDim2.new(1, 0, 0, 10)
	TopFix.Position = UDim2.new(0, 0, 1, -10)
	TopFix.BackgroundColor3 = THEME.Header
	TopFix.BorderSizePixel = 0
	TopFix.Parent = TopBar

	MakeDraggable(TopBar, Window)

	-- Header Line (Horizontal)
	local HeaderLine = Instance.new("Frame")
	HeaderLine.Size = UDim2.new(1, 0, 0, 2)
	HeaderLine.Position = UDim2.new(0, 0, 0, 50)
	HeaderLine.BackgroundColor3 = THEME.Glow
	HeaderLine.BorderSizePixel = 0
	HeaderLine.ZIndex = 5
	HeaderLine.Parent = Window

	local TitleLabel = Instance.new("TextLabel")
	TitleLabel.Size = UDim2.new(1, -50, 1, 0)
	TitleLabel.Position = UDim2.fromOffset(15, 0)
	TitleLabel.BackgroundTransparency = 1
	TitleLabel.Text = config.Title or "Kaze Hub"
	TitleLabel.TextColor3 = THEME.Text
	TitleLabel.Font = Enum.Font.GothamBold
	TitleLabel.TextSize = 16
	TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
	TitleLabel.Parent = TopBar

	-- Content Area
	local Content = Instance.new("Frame")
	Content.Position = UDim2.fromOffset(0, 52) 
	Content.Size = UDim2.new(1, 0, 1, -52)
	Content.BackgroundTransparency = 1
	Content.Parent = Window

	local TAB_WIDTH = 140
	local VerticalLine = Instance.new("Frame")
	VerticalLine.Size = UDim2.new(0, 2, 1, 0)
	VerticalLine.Position = UDim2.new(0, TAB_WIDTH, 0, 0)
	VerticalLine.BackgroundColor3 = THEME.Glow
	VerticalLine.ZIndex = 5
	VerticalLine.Parent = Content

	local TabsScroll = Instance.new("ScrollingFrame")
	TabsScroll.Size = UDim2.new(0, TAB_WIDTH, 1, -10)
	TabsScroll.Position = UDim2.fromOffset(0, 5)
	TabsScroll.BackgroundTransparency = 1
	TabsScroll.ScrollBarThickness = 0
	TabsScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
	TabsScroll.Parent = Content

	local UIList = Instance.new("UIListLayout", TabsScroll)
	UIList.HorizontalAlignment = Enum.HorizontalAlignment.Center
	UIList.Padding = UDim.new(0, 5)

	local Pages = Instance.new("Frame")
	Pages.Size = UDim2.new(1, -TAB_WIDTH - 5, 1, 0)
	Pages.Position = UDim2.fromOffset(TAB_WIDTH + 5, 0)
	Pages.BackgroundTransparency = 1
	Pages.Parent = Content

	local tabs, pages, activeIndex = {}, {}, nil

	local function SetActiveTab(index)
		if activeIndex == index then return end
		activeIndex = index
		for i, t in ipairs(tabs) do
			local isActive = (i == index)
			t.btn.BackgroundColor3 = isActive and Color3.fromRGB(30, 30, 40) or THEME.Background
			t.label.TextColor3 = isActive and THEME.Glow or THEME.TextDim
			t.stroke.Enabled = isActive
			pages[i].Visible = isActive
		end
	end

	--// AddTab function (NO configuration required)
	function handle:AddTab(name)
		local idx = #tabs + 1
		local btn = Instance.new("TextButton")
		btn.Size = UDim2.new(0, 125, 0, 35)
		btn.BackgroundColor3 = THEME.Background
		btn.Text = ""
		btn.Parent = TabsScroll
		Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)

		local stroke = Instance.new("UIStroke")
		stroke.Color, stroke.Thickness, stroke.Enabled = THEME.Glow, 1, false
		stroke.Parent = btn

		local label = Instance.new("TextLabel")
		label.Size = UDim2.new(1, 0, 1, 0)
		label.BackgroundTransparency = 1
		label.Text, label.Font, label.TextSize = name, Enum.Font.GothamMedium, 13
		label.TextColor3 = THEME.TextDim
		label.Parent = btn

		local page = Instance.new("Frame")
		page.Size = UDim2.new(1, -20, 1, -20)
		page.Position = UDim2.fromOffset(10, 10)
		page.BackgroundTransparency, page.Visible = 1, false
		page.Parent = Pages

		table.insert(tabs, {btn = btn, label = label, stroke = stroke})
		table.insert(pages, page)

		btn.MouseButton1Click:Connect(function() SetActiveTab(idx) end)
		if idx == 1 then SetActiveTab(1) end
		return page
	end

	-- Built-in Shortcut: Right Control
	UIS.InputBegan:Connect(function(input, gpe)
		if not gpe and input.KeyCode == Enum.KeyCode.RightControl then
			Window.Visible = not Window.Visible
		end
	end)

	return handle
end

return KazeUI
